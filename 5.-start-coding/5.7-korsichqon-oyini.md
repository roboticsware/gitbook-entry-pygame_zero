# 5.7 Ko'rsichqon oyini yasash - Keng qamrovli

Va nihoyat, sizni ushbu kitobning so'nggi misoliga yetib kelganingiz bilan tabriklayman. Oldingi misollardan o'tganingizdan so'ng, ehtimol siz Python dasturlashdan asta-sekin zavqlana boshladingiz. Umid qilamanki, matnli kodlash siz o'ylagandek murakkab yoki zerikarli emas edi. Agar shunday bo'lsa, siz ushbu kitobning asosiy maqsadiga ‚Äî matnli dasturlash dunyosiga kirishga muvaffaqiyatli erishdingiz deb hisoblashingiz mumkin.

Oxirgi misol hozirgacha misollar to'plamidir, shuning uchun bu avvalgi misollarga qaraganda ancha qiyin. Biroq, bu faqat vaqt talab etadi va siz buni bosqichma-bosqich tushunasiz.

{% code lineNumbers="true" %}
```python
from pgzhelper import *
import random

WIDTH = 960
HEIGHT = 540

bolga = Actor('toy_hammer', (WIDTH / 2, HEIGHT / 2))
bolga.scale = 0.5
bolga.angle = 40

hisob = 0
hammer_pressed = False

GAP_FROM_SCR = 50
korsichqonlar = []
for _ in range(6):
    korsichqon = Actor('mole')
    korsichqon.anchor = ('left', 'top')
    x = random.randint(GAP_FROM_SCR, WIDTH - korsichqon.width + GAP_FROM_SCR)
    y = random.randint(GAP_FROM_SCR, HEIGHT - korsichqon.height + GAP_FROM_SCR)
    korsichqon.pos = (x, y)
    korsichqon.scale = 0.5
    korsichqon.visible = False
    korsichqonlar.append(korsichqon)


def draw():
    global korsichqon
    screen.blit('field', (0, 0))

    for korsichqon in korsichqonlar:
        if korsichqon.visible: 
            korsichqon.draw()
        if hammer_pressed and korsichqon.visible and korsichqon.collide_pixel(bolga):
            sounds.toi.play()
            korsichqonlar.remove(korsichqon)
            score += 1

    hammer.draw()
    screen.draw.text('Hisob: ' + str(hisob), (20, 20), color='black')


def update():
    if random.randint(0, 10) == 0:
        if len(korsichqonlar) != 0:
            mole_list = random.sample(korsichqonlar, 1)
            mole_list[0].visible = not mole_list[0].visible
        else:
            game.exit()


def on_mouse_move(pos):
    bolga.centerx, bolga.centery = pos


def on_mouse_down():
    global hammer_pressed
    hammer_pressed = True
    animate(hammer, angle=75, tween='accelerate', duration=0.1, on_finished=animation_done)
    

def animation_done():
    global hammer_pressed
    animate(hammer, angle=40, tween='accelerate', duration=0.1)
    hammer_pressed = False
```
{% endcode %}

Ko'rsichqon ovlash o'yinining Entry versiyasidan bitta farq bor. Kirish versiyasida mollarning joylashuvi aniqlanadi, ammo pygame zero versiyasida mollarning joylashuvi dastlab tasodifiy o'rnatiladi. Birinchidan, tasodifiylikdan foydalanish uchun tasodifiy deb nomlangan alohida tashqi modul talab qilinadi, shuning uchun modul 2-qatorga import qilinadi. Satrlarni kodi 14 uchun 24 jami yaratadi 6 mol aktyor ob'ektlar tasodifiy ekranda joylashganda kerak, va saqlaydi, bu 6 foydalanish uchun mol deb nomlangan ro'yxatda.

19-20 qatorlarda ishlatiladigan randint usuli yozuvda ishlatiladigan "tasodifiy raqam" blokidan unchalik farq qilmaydi. Muayyan diapazonda tasodifiy raqamni tasodifiy tanlash uchun diapazonning maksimal/minimal qiymatlarini argument sifatida o'tkazishingiz kerak. Biroq, usul nomi int o'z ichiga oladi, deb qayd (integer, integer), bu butun son qator tanlaydi ko'rsatuvchi. Yon eslatma sifatida, agar sizga haqiqiy raqam turining tasodifiy qiymati kerak bo'lsa (float, haqiqiy raqam), siz randfloat deb nomlangan usulni osongina taxmin qilishingiz va ishlatishingiz mumkin.

Randint usuliga o'tgan dastlabki/maksimal qiymatlar GAP\_FROM\_SCR nomi ostida 50 piksel chegarasidan foydalanadi . Maqsad joyni tasodifiy tanlash emas, balki o'yin ekranining chegarasi yonida joy tanlanganda ekranning oxirida ko'rsatilgan mol tasvirini kesib tashlashni oldini olishdir. Shu maqsadda, tasodifiy joylashuv qiymatini ekran chegarasidan 50 pikselga ichkariga siljitish orqali topish uchun margin qiymati taqdim etiladi.

23 qatorda, biz aktyor obyekt bir ajralmas mulk emas aniq deb nomlangan birinchi ob'ekt mulkni foydalanayotgan. Bu bizning shaxsiy mulkimiz bo'lib, biz o'zboshimchalik bilan qo'shdik, chunki bu bizning o'yinimizni rivojlantirish uchun kerak edi. Agar kerak bo'lsa, mavjud ob'ektlarga xususiyatlarni ham qo'shishingiz mumkinligini unutmang. Maqsad shundaki, mol o'yinining tabiatida ba'zi mollar ekranda ko'rinadigan/ko'rinmas bo'lishi kerak va buni farqlash uchun, oxirgi bobda aytib o'tilganidek, bu bayroq o'zgaruvchisining bir turi.

üî¢ O'yin qiziqarli bo'lishi uchun tasodifiy mollarning ko'rinishi/ko'rinmasligi ham tasodifiy bo'lishi kerak. Buni amalga oshiradigan kod yangilash funktsiyasining 44-47 qatorlari. Biz bilamizki, o'yinda foydalaniladigan ob'ektlarning joylashuvi va holati kabi ma'lumotlarni yangilaydigan qayta qo'ng'iroqni yangilash funksiyasi juda tez-tez chaqiriladi, ammo biz qanchalik tez-tezligini aniq bilmasdik. Nihoyat, biz tezlikni eslatib o'tishimiz kerak. U juda tez-tez chaqiriladi, soniyada 60 marta (60FPS). Muammo shundaki, 60 FPS biz uchun juda tez, lekin biz tasodifiy tirik mollarni tanlashimiz kerak (o'yin foydalanuvchisi hali qo'lga kiritmagan) va ularni zavqlanishni qondirish uchun juda tez yoki juda sekin tezlikda ko'rsatish/yashirish kerak. o'yin haqida. Tezlik ma'lum darajada (0 dan 10 gacha bo'lgan qiymatlar orasidan 0 tanlansa) 44-qatorda, tirik mollardan birini tasodifiy tanlash 45-46-qatorlarda tasodifiy.sample usuli va 47-qatorda amalga oshiriladi. tanlangan molning ko‚Äòrinish xususiyatini teskari o‚Äòzgartirish orqali uning ko‚Äòrinib turishini yoki ko‚Äòrinmasligini sozlaydi.

üî¢ Endi qolgan kodning muhim qismi kauchuk bolg'aning animatsiyasi bilan bog'liq. Agar oldingi misoldagi animatsiya Aktyorda bir nechta tasvirning aylanishiga asoslangan animatsiya bo'lsa, bu animatsiya belgilangan vaqt ichida joriy holatdan ma'lum bir pozitsiya yoki burchakka o'tish haqidadir. Kauchuk bolg'a sichqonchani bosganda ob'ektni urgandek ko'rsatish uchun ma'lum bir burchak ostida (75 daraja) tezda oldinga egilishi kerak va keyin tezda hozirgi burchakka (40 daraja) qaytishi kerak. 59-qatorda animatsiya usulidan foydalanish birinchi bo'lib paydo bo'ladi va jami 5 ta argument ishlatiladi. Xulosa qilib aytadigan bo'lsak, qaysi ob'ekt (bolg'a) qaysi xususiyatga (burchakka) qancha vaqt (0,1 soniya) va qanday turdagi (tezlashtirish) animatsiya bajarilishi haqida. Tezlashtirish - bu vaqt o'tishi bilan animatsiya tezligini tezlashtiradigan animatsiya. Hammasi bo'lib 10 ta tur mavjud va ularning har birini kutubxona qo'llanmasi orqali tekshirishingiz mumkin. Bundan tashqari, argument qiymatlari orasidagi oxirgi qiymat bo'lgan on\_finished parametr qiymati bilan qiziqishingiz mumkin. animation\_done ‚Äì 62-qatorda belgilangan funksiya nomi. Parametr qiymatining nomidan ko‚Äòrinib turibdiki, animatsiya tugagandan so‚Äòng argument sifatida berilgan funksiyani chaqirishdir. Turli maqsadlar bo'lishi mumkin, ammo bizning maqsadimiz animatsiyani amalga oshirishdir, bu erda rezina bolg'a egilish animatsiyasi tugagandan so'ng darhol hozirgi holatiga qaytadi.

üî¢ Foydalanuvchi mol ushlaganini qanday bilamiz? Javob 34-qatorda. Uchta shart bajarilishi kerak. Bolg'a animatsiyasi oldinga egilgan bo'lishi kerak (bolg'a ko'tarilayotganda emas), mol ekranda ko'rinadigan, yashirilmagan bo'lishi kerak va bolg'a va mol o'rtasidagi to'qnashuv sinovidan o'tishi kerak. Molni tutish uchun uchta shart ham bajarilishi kerak. Mol muvaffaqiyatli qo'lga kiritilganligi sababli, muvaffaqiyatni ko'rsatish uchun ovoz effekti o'ynaladi (35-qator), qo'lga olingan mol mollar ro'yxatidan chiqariladi (36-qator) va nihoyat, olingan ball hisoblanadi (37-qator).

Bu mol o'yinining barcha kodlarini tushuntirishni tugatadi va nihoyat, o'yinni bajarish natijalarini ko'rib chiqishni tugatamiz.

<figure><img src="../.gitbook/assets/image (1).gif" alt=""><figcaption></figcaption></figure>

Ushbu kitobni shu misolgacha tugatganlarni yana bir bor tabriklayman. Bu bilan siz nihoyat Pygame Zero boshlang'ich darajasidan o'tdingiz. Shunday qilib, endi siz Pygame Zero-ning yanada ilg'or darajasiga o'tishga tayyormiz. Kitobning keyingi darajasida siz Python kodlash ko'nikmalaringizni biz hozirgacha ko'rgan misollardan farq qiladigan va o'yinga o'xshash(?) o'yinlar yaratish orqali yanada qiziqarli tarzda rivojlantirasiz. Siz allaqachon hayajonlanmadingizmi? Matn kodlash bo'yicha birinchi sayohatingizda sizga hamroh bo'lganimdan xursand bo'ldim va muallif sizning sayohatingizda sizni xursand qilishda davom etadi. Bundan tashqari, men kodlash sayohatingizda sizga amaliy yordam beradigan va o'rganishingizga yordam beradigan kodlash vositalari va kitoblarni ishlab chiqarishni davom ettiraman. Va nihoyat, agar sizda tushunarsiz misollar haqida savollaringiz yoki qo'shimcha fikrlaringiz bo'lsa, iltimos, onlayn hamjamiyat orqali bog'laning. Sizning sayohatingiz hech qachon yolg'iz emas!

‚òÄÔ∏è Muallif tomonidan 2024 yilning jazirama yozi oxirida chop etilgan ‚òÄÔ∏è
